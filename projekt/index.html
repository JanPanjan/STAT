<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jan Panjan">
<meta name="dcterms.date" content="2025-09-01">

<title>Domača naloga - Rdeče vino</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#uvod" id="toc-uvod" class="nav-link active" data-scroll-target="#uvod">Uvod</a></li>
  <li><a href="#podatki" id="toc-podatki" class="nav-link" data-scroll-target="#podatki">Podatki</a>
  <ul class="collapse">
  <li><a href="#uporabljeni-paketi" id="toc-uporabljeni-paketi" class="nav-link" data-scroll-target="#uporabljeni-paketi">Uporabljeni paketi</a></li>
  <li><a href="#branje-podatkov" id="toc-branje-podatkov" class="nav-link" data-scroll-target="#branje-podatkov">Branje podatkov</a></li>
  <li><a href="#predstavitev-podatkov" id="toc-predstavitev-podatkov" class="nav-link" data-scroll-target="#predstavitev-podatkov">Predstavitev podatkov</a></li>
  </ul></li>
  <li><a href="#naloga-1." id="toc-naloga-1." class="nav-link" data-scroll-target="#naloga-1.">Naloga 1.</a>
  <ul class="collapse">
  <li><a href="#opis-problema" id="toc-opis-problema" class="nav-link" data-scroll-target="#opis-problema">Opis problema</a></li>
  <li><a href="#opis-uporabljenih-statističnih-metod" id="toc-opis-uporabljenih-statističnih-metod" class="nav-link" data-scroll-target="#opis-uporabljenih-statističnih-metod">Opis uporabljenih statističnih metod</a></li>
  <li><a href="#rezultati-in-njihova-interpretacija" id="toc-rezultati-in-njihova-interpretacija" class="nav-link" data-scroll-target="#rezultati-in-njihova-interpretacija">Rezultati in njihova interpretacija</a>
  <ul class="collapse">
  <li><a href="#porazdelitev-ocen-vina" id="toc-porazdelitev-ocen-vina" class="nav-link" data-scroll-target="#porazdelitev-ocen-vina">Porazdelitev ocen vina</a></li>
  <li><a href="#kislost-vina" id="toc-kislost-vina" class="nav-link" data-scroll-target="#kislost-vina">Kislost vina</a></li>
  <li><a href="#vsebnost-sladkorja" id="toc-vsebnost-sladkorja" class="nav-link" data-scroll-target="#vsebnost-sladkorja">Vsebnost sladkorja</a></li>
  <li><a href="#celotna-vsebnost-žveplovega-dioksida" id="toc-celotna-vsebnost-žveplovega-dioksida" class="nav-link" data-scroll-target="#celotna-vsebnost-žveplovega-dioksida">Celotna vsebnost žveplovega dioksida</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#naloga-2." id="toc-naloga-2." class="nav-link" data-scroll-target="#naloga-2.">Naloga 2.</a></li>
  <li><a href="#naloga-3." id="toc-naloga-3." class="nav-link" data-scroll-target="#naloga-3.">Naloga 3.</a></li>
  <li><a href="#naloga-4." id="toc-naloga-4." class="nav-link" data-scroll-target="#naloga-4.">Naloga 4.</a></li>
  <li><a href="#naloga-5." id="toc-naloga-5." class="nav-link" data-scroll-target="#naloga-5.">Naloga 5.</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Domača naloga - Rdeče vino</h1>
<p class="subtitle lead">Statistika 2024/25</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jan Panjan </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 1, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="uvod" class="level1">
<h1>Uvod</h1>
<p>Kvaliteta vina je odvisna od številnih dejavnikov, od sort grozdja z različnimi lastnostmi, do vinarskih postokov uporabljenih za njegovo predelovanje. Analiza kakovosti vina je pomembna tako za potrošnike, saj jim tako pomaga pri izbiri vina ter pri proizvjalacih, ki lahko na podlagi rezultatov analiz ugotovijo, katere tehnike pridelovanja, sorte grozdja in podobno vpliva na kakovost vina.</p>
<p>V tem poročilu so predstavljene statistične analize podatkov kakovosti rdečega vina. Namen naloge je pripraviti poročilo, ki poda odgovore na vseh 5 zastavljenih vprašanj, ki se osredotočajo na kemijse lastnosti in njihov vpliv na kakovost vina. Uporabljati je bilo potrebno program R. Pri vsakem vprašanju je podan opis problema, opis uporabljenih statističnih metod za analizo problema ter rezultati analize in njihova interpretacija.</p>
</section>
<section id="podatki" class="level1">
<h1>Podatki</h1>
<section id="uporabljeni-paketi" class="level2">
<h2 class="anchored" data-anchor-id="uporabljeni-paketi">Uporabljeni paketi</h2>
<p>Za delo s podatki sem uporabljal paket <code>tidyverse</code>, ki je ustvarjen za delo s podatkovnimi okvirji ter <code>ggplot2</code> in <code>gridExtra</code> za kvalitetne vizualne predstavitve distiliranih podatkov.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="branje-podatkov" class="level2">
<h2 class="anchored" data-anchor-id="branje-podatkov">Branje podatkov</h2>
<p>Podatki so shranjeni tako v <code>csv</code> kot v <code>xlsx</code> obliki. Odločil sem se, da bom uporabil podatke iz <code>csv</code> datoteke, saj za branje ni potrebna uporaba dodatnih paketov.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="st">"winequality-red.csv"</span> <span class="sc">|&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read.csv</span>(<span class="at">sep =</span> <span class="st">";"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="predstavitev-podatkov" class="level2">
<h2 class="anchored" data-anchor-id="predstavitev-podatkov">Predstavitev podatkov</h2>
<p>Podatkovni okvir vsebuje različne kemijske lastnosti vin ter končno oceno kakovosti ocenjevalcev vina. Sestavljen je iz 1599 vrstic z 12 numeričnimi spremenljivkami.</p>
<div class="cell">
<details class="code-fold">
<summary>manjkajoče vrednosti</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map_df</span>(df, \(col){</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">is.na</span>(col) <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grep</span>(<span class="at">pattern =</span> <span class="st">"TRUE"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">length</span>()</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">|&gt;</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(df)) <span class="sc">%&gt;%</span> {</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(.) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"spremenljivka"</span>, <span class="st">"NA"</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    .</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 2
   spremenljivka         `NA`
   &lt;chr&gt;                &lt;int&gt;
 1 fixed.acidity            0
 2 volatile.acidity         0
 3 citric.acid              0
 4 residual.sugar           0
 5 chlorides                0
 6 free.sulfur.dioxide      0
 7 total.sulfur.dioxide     0
 8 density                  0
 9 pH                       0
10 sulphates                0
11 alcohol                  0
12 quality                  0</code></pre>
</div>
</div>
<p>Podatki so že očiščeni, zato dodatno delo ni potrebno.</p>
<div class="cell">
<details class="code-fold">
<summary>naključni vzorec velikosti 5</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 6%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">fixed.acidity</th>
<th style="text-align: right;">volatile.acidity</th>
<th style="text-align: right;">citric.acid</th>
<th style="text-align: right;">residual.sugar</th>
<th style="text-align: right;">chlorides</th>
<th style="text-align: right;">free.sulfur.dioxide</th>
<th style="text-align: right;">total.sulfur.dioxide</th>
<th style="text-align: right;">density</th>
<th style="text-align: right;">pH</th>
<th style="text-align: right;">sulphates</th>
<th style="text-align: right;">alcohol</th>
<th style="text-align: right;">quality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">7.1</td>
<td style="text-align: right;">0.350</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">0.096</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">0.99620</td>
<td style="text-align: right;">3.42</td>
<td style="text-align: right;">0.65</td>
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.6</td>
<td style="text-align: right;">0.855</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">0.99627</td>
<td style="text-align: right;">3.54</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7.8</td>
<td style="text-align: right;">0.520</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">0.99840</td>
<td style="text-align: right;">3.43</td>
<td style="text-align: right;">0.65</td>
<td style="text-align: right;">9.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">11.9</td>
<td style="text-align: right;">0.430</td>
<td style="text-align: right;">0.66</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">0.109</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">1.00000</td>
<td style="text-align: right;">3.15</td>
<td style="text-align: right;">0.85</td>
<td style="text-align: right;">10.4</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7.1</td>
<td style="text-align: right;">0.590</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">0.078</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">0.99522</td>
<td style="text-align: right;">3.42</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">10.8</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>povzetek podatkov</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(df[<span class="fu">names</span>(df)], summary) <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 4%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">fixed.acidity</th>
<th style="text-align: right;">volatile.acidity</th>
<th style="text-align: right;">citric.acid</th>
<th style="text-align: right;">residual.sugar</th>
<th style="text-align: right;">chlorides</th>
<th style="text-align: right;">free.sulfur.dioxide</th>
<th style="text-align: right;">total.sulfur.dioxide</th>
<th style="text-align: right;">density</th>
<th style="text-align: right;">pH</th>
<th style="text-align: right;">sulphates</th>
<th style="text-align: right;">alcohol</th>
<th style="text-align: right;">quality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Min.</td>
<td style="text-align: right;">4.600000</td>
<td style="text-align: right;">0.1200000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.900000</td>
<td style="text-align: right;">0.0120000</td>
<td style="text-align: right;">1.00000</td>
<td style="text-align: right;">6.00000</td>
<td style="text-align: right;">0.9900700</td>
<td style="text-align: right;">2.740000</td>
<td style="text-align: right;">0.3300000</td>
<td style="text-align: right;">8.40000</td>
<td style="text-align: right;">3.000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">1st Qu.</td>
<td style="text-align: right;">7.100000</td>
<td style="text-align: right;">0.3900000</td>
<td style="text-align: right;">0.0900000</td>
<td style="text-align: right;">1.900000</td>
<td style="text-align: right;">0.0700000</td>
<td style="text-align: right;">7.00000</td>
<td style="text-align: right;">22.00000</td>
<td style="text-align: right;">0.9956000</td>
<td style="text-align: right;">3.210000</td>
<td style="text-align: right;">0.5500000</td>
<td style="text-align: right;">9.50000</td>
<td style="text-align: right;">5.000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Median</td>
<td style="text-align: right;">7.900000</td>
<td style="text-align: right;">0.5200000</td>
<td style="text-align: right;">0.2600000</td>
<td style="text-align: right;">2.200000</td>
<td style="text-align: right;">0.0790000</td>
<td style="text-align: right;">14.00000</td>
<td style="text-align: right;">38.00000</td>
<td style="text-align: right;">0.9967500</td>
<td style="text-align: right;">3.310000</td>
<td style="text-align: right;">0.6200000</td>
<td style="text-align: right;">10.20000</td>
<td style="text-align: right;">6.000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mean</td>
<td style="text-align: right;">8.319637</td>
<td style="text-align: right;">0.5278205</td>
<td style="text-align: right;">0.2709756</td>
<td style="text-align: right;">2.538806</td>
<td style="text-align: right;">0.0874665</td>
<td style="text-align: right;">15.87492</td>
<td style="text-align: right;">46.46779</td>
<td style="text-align: right;">0.9967467</td>
<td style="text-align: right;">3.311113</td>
<td style="text-align: right;">0.6581488</td>
<td style="text-align: right;">10.42298</td>
<td style="text-align: right;">5.636023</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3rd Qu.</td>
<td style="text-align: right;">9.200000</td>
<td style="text-align: right;">0.6400000</td>
<td style="text-align: right;">0.4200000</td>
<td style="text-align: right;">2.600000</td>
<td style="text-align: right;">0.0900000</td>
<td style="text-align: right;">21.00000</td>
<td style="text-align: right;">62.00000</td>
<td style="text-align: right;">0.9978350</td>
<td style="text-align: right;">3.400000</td>
<td style="text-align: right;">0.7300000</td>
<td style="text-align: right;">11.10000</td>
<td style="text-align: right;">6.000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Max.</td>
<td style="text-align: right;">15.900000</td>
<td style="text-align: right;">1.5800000</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">15.500000</td>
<td style="text-align: right;">0.6110000</td>
<td style="text-align: right;">72.00000</td>
<td style="text-align: right;">289.00000</td>
<td style="text-align: right;">1.0036900</td>
<td style="text-align: right;">4.010000</td>
<td style="text-align: right;">2.0000000</td>
<td style="text-align: right;">14.90000</td>
<td style="text-align: right;">8.000000</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br></p>
<p>Lahko opazimo, da se pojavijo samo ocene med 3 in 8 ter da je povprečna ocena <span class="math inline">\(\approx 5.5\)</span>. Spodaj je opis vseh spremenljivk.</p>
<table class="table">
<colgroup>
<col style="width: 30%">
<col style="width: 15%">
<col style="width: 54%">
</colgroup>
<thead>
<tr class="header">
<th>spremenljivka</th>
<th>tip</th>
<th>opis</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>fixed.acidity</td>
<td>numerični</td>
<td>kislost vina</td>
</tr>
<tr class="even">
<td>volatile.acidity</td>
<td>numerični</td>
<td>hlapna kislost vina</td>
</tr>
<tr class="odd">
<td>citric.acid</td>
<td>numerični</td>
<td>vsebnost citronske kisline</td>
</tr>
<tr class="even">
<td>residual.sugar</td>
<td>numerični</td>
<td>vsebnost sladkorja</td>
</tr>
<tr class="odd">
<td>chlorides</td>
<td>numerični</td>
<td>vsebnost kloridov</td>
</tr>
<tr class="even">
<td>free.sulfur.dioxide</td>
<td>numerični</td>
<td>vsebnost prostega žveplovega dioksida</td>
</tr>
<tr class="odd">
<td>total.sulfur.dioxide</td>
<td>numerični</td>
<td>celotna vsebnost žveplovega dioksida</td>
</tr>
<tr class="even">
<td>density</td>
<td>numerični</td>
<td>gostota vina</td>
</tr>
<tr class="odd">
<td>pH</td>
<td>numerični</td>
<td>pH nivo vina</td>
</tr>
<tr class="even">
<td>sulphates</td>
<td>numerični</td>
<td>vsebnost sulfatov</td>
</tr>
<tr class="odd">
<td>alcohol</td>
<td>numerični</td>
<td>odstotek alkohola</td>
</tr>
<tr class="even">
<td>quality</td>
<td>numerični</td>
<td>ocenjena kvaliteta vina</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="naloga-1." class="level1">
<h1>Naloga 1.</h1>
<p><strong>Grafično prikažite porazdelitev spremenljivk kislost, sladkor ter celoten žveplov dioksid. Grafično prikažite še porazdelitev kvalitete vseh vin. Narišite še histograme, ki prikazujo porazdelitev kislosti glede na kvaliteto vina. Interpretirajte rezultate.</strong></p>
<section id="opis-problema" class="level2">
<h2 class="anchored" data-anchor-id="opis-problema">Opis problema</h2>
<p>V prvi nalogi se osredotočamo na raziskovanje porazdelitve nekaterih kemijskih lastnosti rdečega vina - kislost vina, vsebnost sladkorja ter celotna vsebnost žveplovega dioksida. Predstavljene so tudi porazdelitve kvalitet vseh ocenjenih vin, preko česar bomo lahko dobili idejo, kako vplivajo te lastnosti na njihovo kakovost.</p>
</section>
<section id="opis-uporabljenih-statističnih-metod" class="level2">
<h2 class="anchored" data-anchor-id="opis-uporabljenih-statističnih-metod">Opis uporabljenih statističnih metod</h2>
<p>Porazdelitve podatkov so predstavljene s histogrami. Za boljšo oceno števila intervalov/razredov sem uporabil Sturges pravilo, ki se poenostavi v formulo <span class="math inline">\(k = 1 + \log_2(n)\)</span>, kjer je <span class="math inline">\(k\)</span> število intervalov in <span class="math inline">\(n\)</span> skupno število elementov. Znotraj vsakega histograma je prikazana tudi porazdelitev ocen vina znotraj dane spremenljivke.</p>
<p>V pomoč sem si ustvaril funkcijo <code>quality_histogram</code>, ki prikaže podano spremenljivko <code>col</code> iz podatkovnega okvirja <code>df</code> s histogramom. Za število razredov uporabi vrednost <code>bins_ocena</code>, izračunano s Sturgesovim pravilom. Kot <code>fill</code> parameter vzame <code>quality_factor</code>, kjer so vrednosti spremenljivke <code>quality</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(df)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>bins_ocena <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">log2</span>(n))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>quality_factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>quality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details class="code-fold">
<summary>quality_histogram</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>quality_histogram <span class="ot">&lt;-</span> <span class="cf">function</span>(df, col) {</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">unlist</span>(<span class="fu">select</span>(df, <span class="fu">all_of</span>(col))), <span class="at">fill =</span> quality_factor)) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> bins_ocena) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Porazdelitev"</span>, col, <span class="st">"glede na oceno"</span>),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">gsub</span>(<span class="at">pattern =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">."</span>, <span class="at">replacement =</span> <span class="st">" "</span>, <span class="at">x =</span> col),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"frekvenca"</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">"ocena"</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"PuRd"</span>) <span class="sc">+</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_classic</span>()</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Prav tako sem ustvaril tri funckije, s katerimi bom predstavil mere centralne tendence ali mere variabilnosti neke spremenljivke glede na njeno simetrično ali asimetrično porazdelitev.</p>
<div class="cell">
<details class="code-fold">
<summary>asim_summary</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>asim_summary <span class="ot">&lt;-</span> <span class="cf">function</span>(df, col) {</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  selected <span class="ot">&lt;-</span> <span class="fu">select</span>(df, <span class="fu">all_of</span>(col))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  unpacked <span class="ot">&lt;-</span> <span class="fu">unlist</span>(selected)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  selected <span class="sc">|&gt;</span> <span class="fu">summarise</span>(</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"min"</span> <span class="ot">=</span> <span class="fu">min</span>(unpacked),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"1. kvartil"</span> <span class="ot">=</span> <span class="fu">quantile</span>(unpacked, <span class="fl">0.25</span>),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mediana"</span> <span class="ot">=</span> <span class="fu">median</span>(unpacked),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"3. kvartil"</span> <span class="ot">=</span> <span class="fu">quantile</span>(unpacked, <span class="fl">0.75</span>),</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"IQR"</span> <span class="ot">=</span> <span class="fu">IQR</span>(unpacked),</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max"</span> <span class="ot">=</span> <span class="fu">max</span>(unpacked),</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>sim_summary</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>sim_summary <span class="ot">&lt;-</span> <span class="cf">function</span>(df, col) {</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  selected <span class="ot">&lt;-</span> <span class="fu">select</span>(df, <span class="fu">all_of</span>(col))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  unpacked <span class="ot">&lt;-</span> <span class="fu">unlist</span>(selected)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  selected <span class="sc">|&gt;</span> <span class="fu">summarise</span>(</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"modus"</span> <span class="ot">=</span> <span class="fu">names</span>(<span class="fu">which.max</span>(<span class="fu">table</span>(<span class="fu">factor</span>(unpacked)))),</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"aritmetična sredina"</span> <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">unlist</span>(unpacked)),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"standardni odklon"</span> <span class="ot">=</span> <span class="fu">sd</span>(<span class="fu">unlist</span>(unpacked)),</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Za vsako spremenljivko sem podal tudi ustrezne mere centralne tendence, primerne za tip porazdelitve (bodisi simetrična ali asimetrična).</p>
</section>
<section id="rezultati-in-njihova-interpretacija" class="level2">
<h2 class="anchored" data-anchor-id="rezultati-in-njihova-interpretacija">Rezultati in njihova interpretacija</h2>
<section id="porazdelitev-ocen-vina" class="level3">
<h3 class="anchored" data-anchor-id="porazdelitev-ocen-vina">Porazdelitev ocen vina</h3>
<div class="cell">
<details class="code-fold">
<summary>graf</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> quality)) <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Porazdelitev ocen"</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"ocena"</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"frekvenca"</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Porazdelitev ocen je precej <strong>simetrična</strong>, kar pomeni, da ni (veliko) osamelcev. Zaradi tega je primerno podati <em>mere centralne tendence</em> - artimetična sredina, modus in standardni odklon.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sim_summary</span>(df, <span class="st">"quality"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">modus</th>
<th style="text-align: right;">aritmetična sredina</th>
<th style="text-align: right;">standardni odklon</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">5.636023</td>
<td style="text-align: right;">0.8075694</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Najbolj pogosta ocena je 5, razpršenost podatkov pa je tudi precej majhna.</p>
</section>
<section id="kislost-vina" class="level3">
<h3 class="anchored" data-anchor-id="kislost-vina">Kislost vina</h3>
<p>Opazno je, da je za spremenljivko <code>fixed.acidity</code> (kislost vina) porazdelitev nekoliko asimetrična desno.</p>
<div class="cell">
<details class="code-fold">
<summary>graf</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quality_histogram</span>(df, <span class="st">"fixed.acidity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Zaradi asimetrične porazdelitve so primerne statistične mere <em>mere variabilnosti</em> - mediana, interkvartilni razmik ter prvi in tretji kvartil, saj so bolj robustne in neobčutljive na osamelce, ki so razlog za asimetrične porazdelitve.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">asim_summary</span>(df, <span class="st">"fixed.acidity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">min</th>
<th style="text-align: right;">1. kvartil</th>
<th style="text-align: right;">mediana</th>
<th style="text-align: right;">3. kvartil</th>
<th style="text-align: right;">IQR</th>
<th style="text-align: right;">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">7.1</td>
<td style="text-align: right;">7.9</td>
<td style="text-align: right;">9.2</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: right;">15.9</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Opazno je, da se z večjo oceno poveča tudi mediana, kar lahko implicira na korelacijo med oceno in kislostjo vina. <strong><em>dodaj nek reference kako je kislost pomebna za kakovost vina</em></strong>.</p>
<p>Iz spodnje tabele je opazno, da je ocene vin precej enakomerno porazdeljene. Višje ocene so malo bolj pogoste, kar lahko pomeni, da so proizvajalci imeli dobro letino.</p>
<div class="cell">
<details class="code-fold">
<summary>povzetek podatkov kislosti vina glede na ocene</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(df, quality, fixed.acidity) <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(quality) <span class="sc">|&gt;</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"1. kvartil"</span> <span class="ot">=</span> <span class="fu">quantile</span>(fixed.acidity, <span class="fl">0.25</span>),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mediana"</span> <span class="ot">=</span> <span class="fu">median</span>(fixed.acidity),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"3. kvartil"</span> <span class="ot">=</span> <span class="fu">quantile</span>(fixed.acidity, <span class="fl">0.75</span>),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"IQR"</span> <span class="ot">=</span> <span class="fu">IQR</span>(fixed.acidity)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ocena =</span> quality) <span class="sc">|&gt;</span> </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">ocena</th>
<th style="text-align: right;">1. kvartil</th>
<th style="text-align: right;">mediana</th>
<th style="text-align: right;">3. kvartil</th>
<th style="text-align: right;">IQR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">7.15</td>
<td style="text-align: right;">7.50</td>
<td style="text-align: right;">9.875</td>
<td style="text-align: right;">2.725</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">6.80</td>
<td style="text-align: right;">7.50</td>
<td style="text-align: right;">8.400</td>
<td style="text-align: right;">1.600</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">7.10</td>
<td style="text-align: right;">7.80</td>
<td style="text-align: right;">8.900</td>
<td style="text-align: right;">1.800</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">7.00</td>
<td style="text-align: right;">7.90</td>
<td style="text-align: right;">9.400</td>
<td style="text-align: right;">2.400</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">7.40</td>
<td style="text-align: right;">8.80</td>
<td style="text-align: right;">10.100</td>
<td style="text-align: right;">2.700</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">7.25</td>
<td style="text-align: right;">8.25</td>
<td style="text-align: right;">10.225</td>
<td style="text-align: right;">2.975</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Visoki IQR vrednosti za oceni 3 in 8 lahko pojasne majhna količina podatkov za ti oceni, 10 in 18 opažanj, kar je malo v primerjavi z ostalimi.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>quality_factor <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  3   4   5   6   7   8 
 10  53 681 638 199  18 </code></pre>
</div>
</div>
</section>
<section id="vsebnost-sladkorja" class="level3">
<h3 class="anchored" data-anchor-id="vsebnost-sladkorja">Vsebnost sladkorja</h3>
<p>Porazdelitev vsebnosti sladkorja je zelo asimetrična v desno. Večina vrednosti je med 0 in približno 5. <strong><em>To se sklada s podatki ki sem jih dobil na tej speltni strani o tem da mora met vino toliko sladkorja ker to pomeni da je ok al neki, najdi reference</em></strong>.</p>
<div class="cell">
<details class="code-fold">
<summary>graf</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quality_histogram</span>(df, <span class="st">"residual.sugar"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Tu so predstavljene mere variabilnosti za dano spremenljivko. Iz IQR vrednosti je res razvidno, da je večina podatkov skoncentriranih med 1. in 3. kvartilom, torej med <span class="math inline">\(\approx 2\)</span> in <span class="math inline">\(2.5\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">asim_summary</span>(df, <span class="st">"residual.sugar"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">min</th>
<th style="text-align: right;">1. kvartil</th>
<th style="text-align: right;">mediana</th>
<th style="text-align: right;">3. kvartil</th>
<th style="text-align: right;">IQR</th>
<th style="text-align: right;">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">0.7</td>
<td style="text-align: right;">15.5</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>To lahko pomeni, da višja koncentracija sladkorja v vinu ni pogosta, saj popači njegov okus. Glede na spodnjo tabelo je razvidno, da so ocene ponovno simetrično porazdeljene, vse z mediano približno <span class="math inline">\(2.2\)</span>. Velika IQR vrednost za oceno 3 pa je verjetno spet odvisna od majhne količine podatkov z oceno 3.</p>
<div class="cell">
<details class="code-fold">
<summary>povzetek podatkov vsebnosti sladkorja v vinu glede na ocene</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(df, quality, residual.sugar) <span class="sc">|&gt;</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(quality) <span class="sc">|&gt;</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"1. kvartil"</span> <span class="ot">=</span> <span class="fu">quantile</span>(residual.sugar, <span class="fl">0.25</span>),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mediana"</span> <span class="ot">=</span> <span class="fu">median</span>(residual.sugar),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"3. kvartil"</span> <span class="ot">=</span> <span class="fu">quantile</span>(residual.sugar, <span class="fl">0.75</span>),</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"IQR"</span> <span class="ot">=</span> <span class="fu">IQR</span>(residual.sugar)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ocena =</span> quality) <span class="sc">|&gt;</span> </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">ocena</th>
<th style="text-align: right;">1. kvartil</th>
<th style="text-align: right;">mediana</th>
<th style="text-align: right;">3. kvartil</th>
<th style="text-align: right;">IQR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.875</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: right;">3.10</td>
<td style="text-align: right;">1.225</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1.900</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: right;">2.80</td>
<td style="text-align: right;">0.900</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.900</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">2.60</td>
<td style="text-align: right;">0.700</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.900</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">2.50</td>
<td style="text-align: right;">0.600</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">2.000</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">2.75</td>
<td style="text-align: right;">0.750</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.800</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: right;">2.60</td>
<td style="text-align: right;">0.800</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="celotna-vsebnost-žveplovega-dioksida" class="level3">
<h3 class="anchored" data-anchor-id="celotna-vsebnost-žveplovega-dioksida">Celotna vsebnost žveplovega dioksida</h3>
<p>Spremenljivka celotne vsebnosti žveplovega dioksida je prav tako v desno asimetrično porazdeljena.</p>
<div class="cell">
<details class="code-fold">
<summary>graf</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quality_histogram</span>(df, <span class="st">"total.sulfur.dioxide"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Zaradi tega bom predstavil njene mere variabilnosti.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">asim_summary</span>(df, <span class="st">"total.sulfur.dioxide"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">min</th>
<th style="text-align: right;">1. kvartil</th>
<th style="text-align: right;">mediana</th>
<th style="text-align: right;">3. kvartil</th>
<th style="text-align: right;">IQR</th>
<th style="text-align: right;">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">289</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Iz njih lahko razberemo, da ima večina vin celotno vsebnost žveplovega dioksida nekje med 22 in 62. Žal nimam enot, a lahko trdim, da to v primerjavi z največje izmerjeno vsebnostjo 289 ni precej velika vrednost.</p>
<p>To lahko pomeni, da so vina s manjšo vsebnostjo žveplovega dioksida bolj razširjena ali pa imajo vina s manjšo vsebnostjo boljši okus in so zato bolj pogosta.</p>
<div class="cell">
<details class="code-fold">
<summary>povzetek podatkov celotne vsebnosti žveplovega dioksida v vinu glede na ocene</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(df, quality, total.sulfur.dioxide) <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(quality) <span class="sc">|&gt;</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"1. kvartil"</span> <span class="ot">=</span> <span class="fu">quantile</span>(total.sulfur.dioxide, <span class="fl">0.25</span>),</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mediana"</span> <span class="ot">=</span> <span class="fu">median</span>(total.sulfur.dioxide),</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"3. kvartil"</span> <span class="ot">=</span> <span class="fu">quantile</span>(total.sulfur.dioxide, <span class="fl">0.75</span>),</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"IQR"</span> <span class="ot">=</span> <span class="fu">IQR</span>(total.sulfur.dioxide)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ocena =</span> quality) <span class="sc">|&gt;</span> </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">ocena</th>
<th style="text-align: right;">1. kvartil</th>
<th style="text-align: right;">mediana</th>
<th style="text-align: right;">3. kvartil</th>
<th style="text-align: right;">IQR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">12.5</td>
<td style="text-align: right;">15.0</td>
<td style="text-align: right;">42.5</td>
<td style="text-align: right;">30.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">14.0</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">49.0</td>
<td style="text-align: right;">35.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">47.0</td>
<td style="text-align: right;">84.0</td>
<td style="text-align: right;">58.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">23.0</td>
<td style="text-align: right;">35.0</td>
<td style="text-align: right;">54.0</td>
<td style="text-align: right;">31.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">17.5</td>
<td style="text-align: right;">27.0</td>
<td style="text-align: right;">43.0</td>
<td style="text-align: right;">25.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">16.0</td>
<td style="text-align: right;">21.5</td>
<td style="text-align: right;">43.0</td>
<td style="text-align: right;">27.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Ocene so ponovno precej enakomerno porazdeljene glede na vrednosti spremenljivke. Malo več jih je skoncentriranih okoli srednjih vrednosti za oceno, 5 in 6, kar je razvidno iz mediane in IQR.</p>
<p><strong><em>Morda so ugotovili optimalno vsebovanost žveplovega dioksida</em></strong></p>
</section>
</section>
</section>
<section id="naloga-2." class="level1">
<h1>Naloga 2.</h1>
<p><strong>Izpišite kvartile in standardni odklon za spremenljivko “kislost” ter narišite okvir z ročaji. Enako naredite še za spremenljivki “sladkor” in “celoten žveplov dioksid”. Interpetirajte rezultate.</strong></p>
</section>
<section id="naloga-3." class="level1">
<h1>Naloga 3.</h1>
<p><strong>Zanima nas, ali je povprečna kislost vin, ki so dobila oceno 5, višja kot povprečne kislosti vin z oceno 6. Katerega od statističnih testov bi uporabili in kakšen je vaš zaključek? Z ustreznim statističnim testom preverite še hipotezo, da je povprečna vsebnost sladkorja vseh izbranih vin večja od 2,3. Interpretirajte rezultate.</strong></p>
</section>
<section id="naloga-4." class="level1">
<h1>Naloga 4.</h1>
<p><strong>Za vsako od dvanajstih zgoraj omenjenih spremenljivk preverite, ali so podatki skladni z normalno porazdelitvijo. Če da, podajte parametre teh porazdelitev.</strong></p>
</section>
<section id="naloga-5." class="level1">
<h1>Naloga 5.</h1>
<p><strong>Po lastni izbiri postavite vsaj še eno raziskovalno vprašanje in nanj natančno odgovorite.</strong></p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>